{% extends "base.html" %}
{% load static %}
{% block content %} 


<link rel="stylesheet" href="{% static 'css/portfolio.css' %}">

<div class="container">
    <!-- First Row -->
    <div class="r1 row first-row">
        <div class="c1 col half-column">
            <!-- Content for the first column -->
            <div class="ptag1">
                <span style="margin-top: 4%;">Total Amount</span>
                <span class="cashnum">${{ cash_left }}</span>
            </div>

        </div>
        <div class="c2 col half-column">
              <!-- Deposit Section -->
              <div class="deposit-section">
                <h4>Deposit Amount</h4>
                <form method="post">
                    {% csrf_token %}
                    <input type="number" name="deposit_amount" step="0.01" placeholder="Enter amount to deposit" required>
                    <button type="submit" class="deposit-btn">Deposit</button>
                </form>
                <!-- Display success/error messages -->
                {% if messages %}
                <div class="messages">
                    {% for message in messages %}
                    <p class="{{ message.tags }}">{{ message }}</p>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
           
        </div>
    </div>
        <!-- Second Row -->
        <div class="r2 row second-row">
            <div class="c3 col full-column">
                <div class="ptag">
                    <span style="margin-top: 4%;">Cash Amount</span>
                    <span class="cashnum">${{ cash_left }}</span>
                </div>
                
            </div>
        </div>

    <!-- Second Row -->
    <div class="r3 row second-row">
        <div class="c4 col full-column">
            <div class="ptag">
                <span style="margin-top: 4%;">Invested Amount</span>
                <span class="cashnum">${{ invested_amount }}</span>
            </div>
            <table class="portfolio-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Quantity</th>
                        <th>Average Price</th>
                        <th>Current Price</th>
                        <th>Returns</th>
                    </tr>
                </thead>
                <tbody>
                    {% for portfolio in portfolios %}
                    <tr>
                        <td>{{ portfolio.instrument }}</td>
                        <td>{{ portfolio.quantity }}</td>
                        <td>{{ portfolio.average_price }}</td>
                        <td>{{ portfolio.current_price|floatformat:4 }}</td>
                        <td>
                            {% if portfolio.returns != 'N/A' %}
                            <span style="color: {% if portfolio.returns > 0 %}green{% else %}red{% endif %};">
                                {% if portfolio.returns > 0 %}
                                    ▲
                                {% elif portfolio.returns < 0 %}
                                    ▼
                                {% endif %}
                                ${{ portfolio.abs_returns|floatformat:2 }} <!-- Use absolute value for display -->
                            </span>
                            {% else %}
                                N/A
                            {% endif %}
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" style="text-align: center;">No data available in your portfolio.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>



{% endblock %}